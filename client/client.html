<head>
  <title>Event Tracking System</title>
</head>

<body>
  {{> page}}
</body>

<template name="page">
  {{> navBar}}
  <div class="container-fluid">

    {{#if loading}}
      <img src="http://viewvc.svn.mozilla.org/vc/addons/trunk/bandwagon/skin/images/spinner.gif?revision=18591&view=co&pathrev=18591">
    {{else}}

      {{> body}}

    {{/if}}
  </div>

</template>

<template name="body">
    <div class="row-fluid">
      <div class="span3">

      {{#if currentUser}}

        <div class="well sidebar-nav sidebar-nav-fixed">
            {{> eventSidebar}}
        </div>

      {{/if}}        
      </div>
      <div class="span9">
        {{#if currentUser}}

            {{#if showError}}
              <div class="alert alert-error">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <strong>{{showError.error}}:</strong> {{showError.details}}.
              </div>
            {{/if}}

            {{#if showSuccess}}
              <div class="alert alert-success">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <strong>{{showSuccess.success}}!</strong> {{showSuccess.details}}.
              </div>
            {{/if}}

           	{{#if showDetails}}
              
              {{> detailsModule}}
              {{#if showSteps}}
                {{> collaboratorsModule}}
              {{/if}}
            {{/if}}

        {{/if}}
	   </div>
    </div>
</template>

<template name="navBar">
  <div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="brand" href="#">Project name</a>
      <div class="nav-collapse collapse">
        <p class="navbar-text pull-right">
            {{loginButtons align="right"}}
        </p>
        <ul class="nav">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>
</template>

<template name="eventSidebar">
  <ul class="nav nav-list">
    <li class="nav-header">My Events</li>
      <li class="divider"></li>		
        {{#each eventBlock}}
          {{> event}}
        {{/each}}
        <li class="{{addEventClass}}"><a id="addEvent" href="#"><small>Add event...</small></a></li>
   </ul>
</template>


<template name="event">
  <li class="{{listItemClass}}">
    <a id="event" href="#">{{name}}
      <ul class="nav nav-list">
        <li class="inactive"><i class="icon-home"></i>  <small>{{venue}}</small></li>
        <li class="inactive start"><i class="icon-time"></i>  <small>{{startTimeDisp}}</small></li>
        <li class="inactive end"><i class="icon-minus"></i>  <small>{{endTimeDisp}}</small></li>
      </ul>
    </a>
  </li>
  <li class="divider"></li>
</template>

<template name="detailsModule">
  <div class="page-header">
    <h1>{{moduleHeader}}</h1>
  </div>
  <div class="control-group">
    <label class="control-label" for="eventName">Name</label>
	<div class="controls">
	  <input class="input-xlarge" type="text" id="name" value="{{eventName}}">
    </div>
  </div>
  {{#constant}}
  <div class="control-group">
  	<label class="control-label" for="startTime">Start</label>
    <div id="startTime" class="input-append">
      <input id="startTimeField" data-format="MM/dd/yyyy HH:mm PP" type="text" disabled></input>
      <span class="add-on">
        <i data-time-icon="icon-time" data-date-icon="icon-calendar">
        </i>
      </span>
    </div>
    <label class="control-label" for="endTime">End</label>
    <div id="endTime" class="input-append">
      <input id="endTimeField" data-format="MM/dd/yyyy HH:mm PP" type="text"  disabled></input>
      <span class="add-on">
        <i data-time-icon="icon-time" data-date-icon="icon-calendar">
        </i>
      </span>
    </div>    
  {{/constant}}    
  <p class="muted">{{updateText}}</p>
	<div class="form-actions">
      <button id="add" class="btn btn-primary">{{buttonName}}</button>
      <button id="cancel" class="btn">Cancel</button>
    </div>
  </div>
</template>

<template name="collaboratorsModule">
   <div class="page-header">
    <h1>2. Add collaborators</h1>
  </div>
  <div class="row-fluid">
    <h2>Collaborators</h2>
  </div>
  <ul>
    {{#each help}}
      <li class="span4"><strong>{{profile.name}}</strong></li>
    {{/each}}
  </ul>
  <div class="row-fluid">
    <div class="form-actions">
      <a data-toggle="modal" href="#example" class="btn btn-primary">Manage your troops!</a>
    </div>
  </div>

  {{> collaboratorsModal}}
</template>

<template name="collaboratorsModal">
  <div class="container">
    <div class="modal hide fade in" id="example" style="display: none; ">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">Ã—</a>
            <h3>Troops</h3>
        </div>
        <div id="collaboratorModal" class="modal-body">
            <ul>
            {{#each others}}
             <li class="span4"><label class="checkbox">{{profile.name}}<input userId="{{_id}}" type="checkbox"></label></li>
            {{/each}}
            <li class="span4"><p class="muted">Invite more users!</p></li>
            </ul>
        </div>
        <div class="modal-footer">
            <a id="addCollaborator" data-dismiss="modal"class="btn btn-success" href="#">Call to action</a>
            <a class="btn" data-dismiss="modal" href="#">Close</a>
        </div>
    </div>
  </div>
</template>